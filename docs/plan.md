# Plan - Inventory Upgrade Sprint

## å½“å‰è¿­ä»£
- è¿­ä»£ï¼šSprint Upgrade-Design
- å‘¨æœŸï¼š2026-02-15 ~ 2026-02-18
- ç›®æ ‡ï¼šå®Œæˆâ€œå¤šå®¢æˆ· + é€šç”¨è´§ç±» + å…¥åº“è¡¥å…¨ + å‡ºåº“ç™»è®°æ ¡éªŒâ€æ–¹æ¡ˆè®¾è®¡å¹¶å¾…æ‹æ¿
- çŠ¶æ€ï¼šğŸŸ¡ è¿›è¡Œä¸­ï¼ˆæ–¹æ¡ˆé˜¶æ®µï¼‰

## ä»»åŠ¡æ¸…å•

| åºå· | ä»»åŠ¡ | ç±»å‹ | è®¾è®¡æ–‡æ¡£ | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ |
|---|---|---|---|---|---|
| D1 | æ¢³ç†Excelå…¨Tabå­—æ®µä¸å·®å¼‚ | Analysis | requirements.md | 1h | âœ… |
| D2 | å®šä¹‰ä¸šåŠ¡è§„åˆ™ï¼ˆå¯ç”¨ä»¶æ•°ã€å‡ºåº“æ ¡éªŒã€æ”¹å•ã€é™„ä»¶ï¼‰ | Product | requirements.md | 1h | âœ… |
| D3 | è®¾è®¡æ•°æ®æ¨¡å‹å‡çº§ï¼ˆtenant/category/inbound/outbound/historyï¼‰ | API | api-v2.md(å¾…å»º) | 3h | ğŸ”µ |
| D4 | è®¾è®¡è¿ç§»æ–¹æ¡ˆï¼ˆæ—§è¡¨åˆ°æ–°ç»“æ„ï¼‰ | DB | api-v2.md(å¾…å»º) | 2h | ğŸ”µ |
| D5 | è®¾è®¡åå°äº¤äº’æ–¹æ¡ˆï¼ˆç®¡ç†å‘˜å‡ºåº“/é€‰è´§ï¼‰ | UI | ui-admin-v2.md(å¾…å»º) | 2h | ğŸ”µ |
| D6 | å½¢æˆå®æ–½æ’æœŸä¸éªŒæ”¶æµ‹è¯•æ¸…å• | PM | progress.md | 1h | ğŸ”µ |

## æ‹Ÿè®®æŠ€æœ¯æ–¹æ¡ˆï¼ˆæ‹æ¿å‰ï¼‰

### 1) æ•°æ®ç»“æ„ï¼ˆç›®æ ‡ï¼‰
- `tenants`ï¼šå®¢æˆ·ä¸»æ•°æ®
- `categories`ï¼šè´§ç±»ä¸»æ•°æ®ï¼ˆæ˜ å°„Excel tabï¼‰
- `inventory_inbound`ï¼šå…¥åº“æµæ°´
- `inventory_outbound`ï¼šå‡ºåº“æµæ°´
- `inventory_balance`ï¼šæŒ‰ tenant+category+batch èšåˆåº“å­˜
- `record_history`ï¼šå•æ®ä¿®æ”¹å†å²ï¼ˆå­—æ®µçº§diffï¼‰
- `attachments`ï¼šé™„ä»¶å…ƒæ•°æ®ï¼ˆR2 key, uploader, typeï¼‰

### 2) åº“å­˜æ ¡éªŒä¸å®¡æ‰¹
- å‡ºåº“æ—¶é”å®šç»´åº¦ï¼š`tenant + category + batch`
- æ ¡éªŒå…¬å¼ï¼š`å¯å‡ºåº“ä»¶æ•° >= æœ¬æ¬¡å‡ºåº“ä»¶æ•°`ï¼Œå¦åˆ™æ‹’ç»
- å¯å‡ºåº“ä»¶æ•°æ¥æºï¼š`inventory_balance.available_qty`
- è§’è‰²å®¡æ‰¹æµï¼š
  - ç®¡ç†å‘˜åˆ›å»ºå…¥åº“/å‡ºåº“ï¼šç›´æ¥ç”Ÿæ•ˆ
  - Agent åˆ›å»º/æ›´æ–°ï¼šè¿›å…¥å¾…å®¡æ‰¹ï¼Œç®¡ç†å‘˜å®¡æ‰¹åç”Ÿæ•ˆ
- å¼‚å¸¸å­—æ®µï¼ˆå/æ±¡/æ¹¿/çŸ­/å¤š/çƒ‚ï¼‰æ”¯æŒåè¡¥ï¼Œåè¡¥å†™å…¥ä¿®æ”¹å†å²

### 3) é€šç”¨è´§ç±»
- category æŒ‚â€œå­—æ®µæ¨¡æ¿â€ï¼š
  - åŸºç¡€å¼‚å¸¸å­—æ®µï¼šç ´/æ±¡/æ¹¿/çŸ­
  - å¯é€‰æ‰©å±•ï¼šå¤šåŒ…/çƒ‚åŒ…
- å‰ç«¯è¡¨å•æŒ‰æ¨¡æ¿åŠ¨æ€æ¸²æŸ“

### 4) å¤šå®¢æˆ·
- è¯·æ±‚ä¸Šä¸‹æ–‡å¿…é¡»å¸¦ tenantï¼ˆtoken/sessionï¼‰
- æ‰€æœ‰è¯»å†™å¼ºåˆ¶ tenant è¿‡æ»¤

## ä¾èµ–å…³ç³»
D3 -> D4 -> D5 -> D6

## è¾“å‡ºç‰©
- requirements.md âœ…
- plan.md âœ…
- progress.md âœ…ï¼ˆæŒç»­æ›´æ–°ï¼‰
- api-v2.mdï¼ˆå¾…å»ºï¼‰
- ui-admin-v2.mdï¼ˆå¾…å»ºï¼‰

## Change Log
| æ—¥æœŸ | å˜æ›´å†…å®¹ | åŸå›  | æ“ä½œäºº |
|---|---|---|---|
| 2026-02-15 | åˆ›å»ºå‡çº§è®¡åˆ’åˆç‰ˆ | ç”¨æˆ·è¦æ±‚å…ˆæ‹æ–¹æ¡ˆå†ç¼–ç  | å…‰å¹´ |
